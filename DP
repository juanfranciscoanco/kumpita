WITH TB_MONTOS AS (
	SELECT 
	COD_PRODUCTO_ASOC = CASE WHEN COD_PRODUCTO = 'DP001' THEN 'DP001'
							 WHEN COD_PRODUCTO = 'DP002' THEN 'DP001' 
							 WHEN COD_PRODUCTO = 'DP005' THEN 'DP005'
							 WHEN COD_PRODUCTO = 'DP006' THEN 'DP005'
							 END,
	COD_EMPRESA,
	COD_PRODUCTO,
	COD_MONEDA,
	MON_MIN
	FROM DP_DATOS_X_PRODUCTO 
)
SELECT A.COD_PRODUCTO, 
SOLES = A.MON_MIN, 
DOLARES = B.MON_MIN
FROM TB_MONTOS A
INNER JOIN TB_MONTOS B
ON A.COD_PRODUCTO_ASOC = B.COD_PRODUCTO_ASOC 
AND A.COD_MONEDA = B.COD_MONEDA - 1
